{% extends 'base.html' %}
{% block content %}
<div class="container mt-5">
    <h1 class="text-center mb-4">Usuarios Registrados</h1>
    <!-- Formulario de búsqueda -->
    <form method="get" action="{% url 'buscar_usuarios' %}" class="d-flex mb-4">
        <input type="text" name="q" value="{{ query }}" class="form-control me-2" placeholder="Buscar por username o nombre completo">
        <select name="filtro" class="form-select me-2">
            <option value="todos" {% if filtro == "todos" %}selected{% endif %}>Todos</option>
            <option value="bloqueados" {% if filtro == "bloqueados" %}selected{% endif %}>Bloqueados</option>
            <option value="admin" {% if filtro == "admin" %}selected{% endif %}>Admin</option>
            <option value="empleado" {% if filtro == "empleado" %}selected{% endif %}>Empleado</option>
            <option value="cliente" {% if filtro == "cliente" %}selected{% endif %}>Cliente</option>
        </select>
        <button type="submit" class="btn btn-primary">Buscar</button>
    </form>
    
    
    <table class="table table-striped table-bordered">
        <thead class="table-dark">
            <tr>
                <th>#</th>
                <th>Nombre de Usuario</th>
                <th>Nombre Completo</th>
                <th>Email</th>
                <th>Grupos</th>
                <th>Acciones</th>
            </tr>
        </thead>
        <tbody>
            {% for item in usuarios_con_grupos %}
            <tr>
                <td>{{ forloop.counter }}</td>
                <td>{{ item.usuario.username }}</td>
                <td>{{ item.usuario.get_full_name|default:"Sin nombre" }}</td>
                <td>{{ item.usuario.email|default:"No proporcionado" }}</td>
                <td>{{ item.grupos }}</td>
                <td class="text-center">
                    <!-- Botón para ver el perfil del usuario -->
                    <a href="{% url 'detalle_usuario' item.usuario.id %}" class="btn btn-sm btn-info">
                        <i class="bi bi-eye"></i> <!-- Ícono de lupa de Bootstrap -->
                        Ver Perfil
                    </a>
                </td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="6" class="text-center">No hay usuarios registrados.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
